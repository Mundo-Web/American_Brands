import{R as a,r as o}from"./FilterContainer-TykbAVkI.js";import{C as M,c as O}from"./CreateReactScript-qyXjqq-l.js";import{F as w,P as R,a as T}from"./ProductCard-vdXNsSr6.js";import{m as z}from"./main-jzs2GwAM.js";import{a as B}from"./arrayJoin-Fk5sgFcM.js";import"./_commonjsHelpers-4gQjN7DL.js";import"./index-GBzf7Cls.js";import"./CreateReactScript-JKK_oT5p.js";import"./axios-_sX4vCAy.js";import"./ProductCard-ssICDoe4.js";const J=({minPrice:m,maxPrice:u,categories:h,tags:x,attribute_values:k,id_cat:d,tag_id:f,subCatId:b})=>{o.useEffect(()=>{const t=document.createElement("script");return t.src="https://cdn.sode.me/extends/notify.extend.min.js",t.async=!0,document.body.appendChild(t),()=>{document.body.removeChild(t)}},[null]);const[F,C]=o.useState([]),[e,g]=o.useState(d?{category_id:[d]}:{"txp.tag_id":[f]}),[p,N]=o.useState(0),[c,y]=o.useState(1),[S,E]=o.useState(!1);o.useEffect(()=>{b!==null&&g({...e,subcategory_id:[b]})},[]),o.useEffect(()=>{y(1),_()},[e]),o.useEffect(()=>{_()},[c]);const _=async()=>{const t=[];if((e.maxPrice||e.minPrice)&&(e.maxPrice&&e.minPrice?t.push([[["precio",">=",e.minPrice],"or",["descuento",">=",e.minPrice]],"and",[["precio","<=",e.maxPrice],"or",["descuento","<=",e.maxPrice]]]):e.minPrice?t.push([["precio",">=",e.minPrice],"or",["descuento",">=",e.minPrice]]):e.maxPrice&&t.push([["precio","<=",e.maxPrice],"or",["descuento","<=",e.maxPrice]])),e["txp.tag_id"]&&e["txp.tag_id"].length>0){const r=[];e["txp.tag_id"].forEach((i,s)=>{s==0?r.push(["txp.tag_id","=",i]):r.push("or",["txp.tag_id","=",i])}),t.push(r)}for(const r in e){if(!r.startsWith("attribute-")||e[r].length==0)continue;const[,i]=r.split("-"),s=[];e[r].forEach((v,j)=>{j==0?s.push(["apv.attribute_value_id","=",v]):s.push("or",["apv.attribute_value_id","=",v])}),t.push([["a.id","=",i],"and",s])}if(e.category_id&&e.category_id.length>0){const r=[];e.category_id.forEach((i,s)=>{s==0?r.push(["categoria_id","=",i]):r.push("or",["categoria_id","=",i])}),t.push(r)}if(e.subcategory_id&&e.subcategory_id.length>0){const r=[];e.subcategory_id.forEach((i,s)=>{s==0?r.push(["subcategory_id","=",i]):r.push("or",["subcategory_id","=",i])}),t.push(r)}const{status:l,result:n}=await z.Fetch("/api/products/paginate",{method:"POST",body:JSON.stringify({requireTotalCount:!0,filter:B([...t,["products.visible","=",!0]],"and"),take:12,skip:12*(c-1)})});C((n==null?void 0:n.data)??[]),N((n==null?void 0:n.totalCount)??0)},P=k.reduce((t,l)=>(t[l.attribute_id]||(t[l.attribute_id]=[]),t[l.attribute_id].push(l),t),{});return a.createElement(a.Fragment,null,a.createElement("style",null),a.createElement("form",{className:"flex flex-col md:flex-row gap-6  mx-auto font-poppins bg-[#F1F1F1] w-full",style:{padding:"40px"}},a.createElement("section",{className:"hidden md:flex md:flex-col gap-4 md:basis-3/12 bg-white p-6 rounded-lg h-max md:sticky top-2"},a.createElement(w,{setFilter:g,filter:e,minPrice:m??0,maxPrice:u??0,categories:h,tags:x,attribute_values:Object.values(P),selected_category:d,tag_id:f})),a.createElement("section",{className:"flex flex-col gap-6 md:basis-9/12"},a.createElement("div",{className:"w-full bg-white rounded-lg font-medium flex flex-row justify-between items-center px-2 py-3"},a.createElement("div",{className:"flex flex-row gap-2"},a.createElement("span",{className:"font-normal text-[17px] text-[#666666] ml-3"},"Mostrando ",(c-1)*12+1," - ",c*12>p?p:c*12," de ",p," resultados"),a.createElement("button",{type:"button",className:"md:hidden text-[#006BF6]",onClick:()=>E(!0)}," Mostrar Filtros"))),a.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4 gap-4 md:pr-4"},F.map((t,l)=>a.createElement(R,{key:`product-${t.id}`,item:t,bgcolor:"bg-white"}))),a.createElement("div",{className:"w-full font-medium flex flex-row justify-center items-center"},a.createElement(T,{current:c,setCurrent:y,pages:Math.ceil(p/12)}))),S&&a.createElement("div",{className:"fixed z-40 top-0 left-0 w-full h-full bg-black bg-opacity-50 flex justify-center items-center max-h-[80vh] ",id:"modal"},a.createElement("div",{className:"z-50 flex items-center content-center justify-center absolute  p-4 bg-black rounded-full h-6 w-6",style:{top:"20px",right:"20px"}},a.createElement("button",{type:"button",onClick:()=>E(!1),className:"text-white text-md "},"X")),a.createElement("div",{className:"flex flex-col gap-4 md:basis-3/12 bg-white p-6 rounded-lg top-2 overflow-y-auto",style:{maxHeight:"90vh",maxWidth:"85vh"}},a.createElement(w,{setFilter:g,filter:e,minPrice:m??0,maxPrice:u??0,categories:h,tags:x,attribute_values:Object.values(P),selected_category:d,tag_id:f})))))};M((m,u)=>{O(m).render(a.createElement(J,{...u}))});
